!function(e){var t={};function n(d){if(t[d])return t[d].exports;var i=t[d]={i:d,l:!1,exports:{}};return e[d].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,d){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:d})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var d=Object.create(null);if(n.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(d,i,function(t){return e[t]}.bind(null,i));return d},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(0);function d(e,t,n=""){const d=document.createElement(e);return d.className=t,d.innerHTML=n,d}function i(e,t,n){const i=function(e){const t=new Date(e);function n(e){let t=e.toString();return 1===t.length&&(t=`0${t}`),t}let d=t.getFullYear();d=d.toString().substring(2,4);let i=t.getMonth()+1;i=n(i);let r=t.getDate();r=n(r);let a=t.getHours();a=n(a);let s=t.getMinutes();s=n(s);let o=t.getSeconds();return o=n(o),`${a}:${s}:${o} ${r}.${i}.${d}`}(t),r=d("div","worklog-container"),a=d("div","worklog-date",`${i}`),s=d("div","worklog-id-container",`<div>Server:</div><div>${e}</div>`),o=d("div","worklog-info-container",`<div>INFO:</div><div>${n}</div>`);return r.appendChild(a),r.appendChild(s),r.appendChild(o),r}function r(e,t,n,r,a){const s=d("div","server-container"),o=d("div","server-header",`${e}`),c=d("div","server-status-container","<div>Status:</div>"),l=d("div","server-running","<span>&#11044;</span> Running"),p=d("div","server-stopped","<span>&#11044;</span> Stopped"),v=d("div","server-actions-container","<div>Actions:</div>"),u=d("div","server-action server-start","<div>&#9654;</div>"),h=d("div","server-action server-stop","<div>&#8214;</div>"),f=d("div","server-action server-delete","<div>&#10006;</div>");function m(e){const t=i(JSON.parse(e.data).id,+new Date,'Received "Start command"');n.appendChild(t),n.scrollTop=n.scrollHeight,r.removeEventListener("received",m)}function g(e){const t=i(JSON.parse(e.data).id,+new Date,"Started");n.appendChild(t),n.scrollTop=n.scrollHeight,u.classList.add("disabled"),h.classList.remove("disabled"),p.classList.add("disabled"),l.classList.remove("disabled"),r.removeEventListener("started",g)}function L(e){const t=i(JSON.parse(e.data).id,+new Date,'Received "Stop command"');n.appendChild(t),n.scrollTop=n.scrollHeight,r.removeEventListener("received",L)}function b(e){const t=i(JSON.parse(e.data).id,+new Date,"Stopped");n.appendChild(t),n.scrollTop=n.scrollHeight,h.classList.add("disabled"),u.classList.remove("disabled"),l.classList.add("disabled"),p.classList.remove("disabled"),r.removeEventListener("stopped",b)}function C(e){const t=i(JSON.parse(e.data),+new Date,'Received "Delete command"');n.appendChild(t),n.scrollTop=n.scrollHeight,r.removeEventListener("received",C)}function S(e){const t=i(JSON.parse(e.data),+new Date,"Deleted");n.appendChild(t),s.remove(),r.removeEventListener("stopped",S)}return"running"===t&&(p.classList.add("disabled"),u.classList.add("disabled")),"stopped"===t&&(l.classList.add("disabled"),h.classList.add("disabled")),c.appendChild(l),c.appendChild(p),v.appendChild(u),v.appendChild(h),v.appendChild(f),s.appendChild(o),s.appendChild(c),s.appendChild(v),u.addEventListener("click",()=>{!async function(){await fetch(`${a}/instances`,{method:"PUT",body:JSON.stringify({id:e,state:"running",action:"started"})})}(),r.addEventListener("received",m),r.addEventListener("started",g)}),h.addEventListener("click",()=>{!async function(){await fetch(`${a}/instances`,{method:"PUT",body:JSON.stringify({id:e,state:"stopped",action:"stopped"})})}(),r.addEventListener("received",L),r.addEventListener("stopped",b)}),f.addEventListener("click",()=>{!async function(){await fetch(`${a}/instances/${e}`,{method:"DELETE"})}(),r.addEventListener("received",C),r.addEventListener("deleted",S)}),s}const a=document.querySelector("body"),s=d("div","main-container"),o=d("div","servers data-container"),c=d("div","container-header","<p>Your micro instances:</p>"),l=d("div","servers-wrapper"),p=d("button","add-server-btn","<p>Create new instance</p>");p.type="button",o.appendChild(c),o.appendChild(l),o.appendChild(p);const v=d("div","worklog data-container"),u=d("div","container-header","<p>Worklog:</p>"),h=d("div","worklog-wrapper");v.appendChild(u),v.appendChild(h),s.appendChild(o),s.appendChild(v),a.insertBefore(s,a.firstChild);const f="https://ahj-homework-8-3.herokuapp.com",m=new EventSource(`${f}/sse`);function g(e){const t=i(JSON.parse(e.data).id,+new Date,'Received "Create command"');h.appendChild(t),h.scrollTop=h.scrollHeight,m.removeEventListener("received",g)}function L(e){const t=JSON.parse(e.data),n=r(t.id,t.state,h,m,f);l.appendChild(n),l.scrollTop=l.scrollHeight;const d=i(t.id,+new Date,"Created");h.appendChild(d),h.scrollTop=h.scrollHeight,m.removeEventListener("created",L)}!async function(){const e=await fetch(`${f}`);if(e.ok){(await e.json()).forEach(e=>{const t=r(e.id,e.state,h,m,f);l.appendChild(t),l.scrollTop=l.scrollHeight})}}(),p.addEventListener("click",()=>{!async function(){await fetch(`${f}/instances`,{method:"POST"})}(),m.addEventListener("received",g),m.addEventListener("created",L)})}]);